
http://www.lc365.net/blog/b/23997/

499是nginx自定义的一个状态码，在src/http/ngx_http_special_response.c文件中有这个状态码的解释。


494:请求头太大

495:https证书错误

496:https 没有证书

497:http到https

498:取消

499:客户端关闭链接（服务器端处理的时间过长，客户端“不耐烦”了，断开了链接。）


出现499错误的常见案例：

1、确实是客户端关闭了连接,或者说连接超时 ,无论你设置多少超时时间多没用 原来是php进程不够用了（默认测试环境才开5个子进程）

解决：改善一下php进程数，问题解决。

 

2、nginx反代到一个永远打不开的后端，客户端请求超时，主动断开连接，日志状态记录是499、发送字节数是0。

解决：换成能打开的后端

 

3、打开Nginx的access.log发现在最后一次的提交是出现了HTTP1.1499 0 -这样的错误，但是使用端口+IP直接访问后端服务器不存在此问题，后来测试nginx发现如果两次提交post过快就会出现499的情况，看来是nginx认为是不安全的连接，主动拒绝了客户端的连接.

proxy_ignore_client_abort on;

Don’t know if this is safe.

就是说要配置参数 proxy_ignore_client_abort on;表示代理服务端不要主要主动关闭客户端连接。以此配置重启nginx,问题果然得到解决。只是安全方面稍有欠缺，但比总是出现找不到服务器好多了。
